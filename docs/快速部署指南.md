# ğŸš€ witdot Education AI Platform - å¿«é€Ÿéƒ¨ç½²æŒ‡å—

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. æœåŠ¡å™¨è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: CentOS 7/8 æˆ– RHEL 7/8
- **é…ç½®**: æœ€ä½ 2æ ¸4GBï¼Œæ¨è 4æ ¸8GB
- **ç½‘ç»œ**: éœ€è¦å…¬ç½‘ IP åœ°å€
- **æƒé™**: root ç”¨æˆ·æˆ–å…·æœ‰ sudo æƒé™

### 2. å¼€æ”¾å®‰å…¨ç»„ç«¯å£

**é‡è¦**: åœ¨è¿è¡Œéƒ¨ç½²è„šæœ¬å‰ï¼Œå¿…é¡»å…ˆå¼€æ”¾ä»¥ä¸‹ç«¯å£ï¼š

#### é˜¿é‡Œäº‘ ECS å®‰å…¨ç»„è®¾ç½®
1. ç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å°
2. è¿›å…¥ **äº‘æœåŠ¡å™¨ ECS** â†’ **å®ä¾‹**
3. é€‰æ‹©ä½ çš„æœåŠ¡å™¨å®ä¾‹
4. ç‚¹å‡» **æ›´å¤š** â†’ **ç½‘ç»œå’Œå®‰å…¨ç»„** â†’ **å®‰å…¨ç»„é…ç½®**
5. ç‚¹å‡» **é…ç½®è§„åˆ™**
6. æ·»åŠ ä»¥ä¸‹å…¥æ–¹å‘è§„åˆ™ï¼š

| ç«¯å£èŒƒå›´ | æˆæƒå¯¹è±¡ | è¯´æ˜ |
|---------|---------|------|
| 80/80 | 0.0.0.0/0 | HTTPï¼ˆå¿…é¡»ï¼‰ |
| 22/22 | 0.0.0.0/0 | SSHï¼ˆå·²æœ‰ï¼‰ |

**æ³¨æ„**: å¦‚æœåç»­éœ€è¦ HTTPSï¼Œè¿˜éœ€è¦å¼€æ”¾ 443 ç«¯å£ã€‚

#### è…¾è®¯äº‘/å…¶ä»–äº‘æœåŠ¡å•†
ç±»ä¼¼æ­¥éª¤ï¼Œåœ¨å®‰å…¨ç»„æˆ–é˜²ç«å¢™è§„åˆ™ä¸­å¼€æ”¾ 80 ç«¯å£ã€‚

---

## ğŸ¯ ä¸€é”®éƒ¨ç½²æ­¥éª¤

### 1. è¿æ¥åˆ°æœåŠ¡å™¨
```bash
ssh root@47.96.174.6
```

### 2. è¿›å…¥é¡¹ç›®ç›®å½•
```bash
cd /mnt/sda2/code/edu_app
```

### 3. è¿è¡Œéƒ¨ç½²è„šæœ¬
```bash
sudo ./deploy.sh
```

### 4. æŒ‰ç…§æç¤ºæ“ä½œ

#### æ­¥éª¤1ï¼šIP åœ°å€é€‰æ‹©
è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹ï¼š
- **å†…ç½‘ IP**: 172.26.43.219ï¼ˆä»…å†…ç½‘è®¿é—®ï¼‰
- **å…¬ç½‘ IP**: 47.96.174.6ï¼ˆå…¬ç½‘å¯è®¿é—®ï¼‰

```
è¯·é€‰æ‹©è¦ä½¿ç”¨çš„ IP åœ°å€ [1=å…¬ç½‘IP, 2=å†…ç½‘IP, 3=æ‰‹åŠ¨è¾“å…¥] (é»˜è®¤: 1):
```
**æ¨è**: ç›´æ¥æŒ‰ Enter ä½¿ç”¨å…¬ç½‘ IP

#### æ­¥éª¤2ï¼šåç«¯é…ç½®
```
è¯·è¾“å…¥åç«¯æœåŠ¡ç«¯å£ [é»˜è®¤: 3210]:
```
**æ¨è**: ç›´æ¥æŒ‰ Enter ä½¿ç”¨é»˜è®¤ç«¯å£

```
è¯·è¾“å…¥ MongoDB æ•°æ®åº“å [é»˜è®¤: edu_app_prod]:
```
**æ¨è**: ç›´æ¥æŒ‰ Enter ä½¿ç”¨é»˜è®¤æ•°æ®åº“å

```
è¯·è¾“å…¥ JWT Secret (ç•™ç©ºå°†è‡ªåŠ¨ç”Ÿæˆ):
```
**æ¨è**: ç›´æ¥æŒ‰ Enter è‡ªåŠ¨ç”Ÿæˆå®‰å…¨å¯†é’¥

#### æ­¥éª¤3ï¼šAPI Key é…ç½®
```
è¯·è¾“å…¥ Claude API Key:
```
**å¿…é¡»è¾“å…¥**: ä½ çš„ Claude API Keyï¼ˆæ ¼å¼ï¼šsk-ant-api03-xxxxxï¼‰

### 5. ç­‰å¾…è‡ªåŠ¨éƒ¨ç½²å®Œæˆ

è„šæœ¬ä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
- âœ… å®‰è£… Node.js 18ã€MongoDB 6ã€Nginxã€PM2
- âœ… é…ç½®ç¯å¢ƒå˜é‡
- âœ… å®‰è£…é¡¹ç›®ä¾èµ–
- âœ… æ„å»ºå‰ç«¯ä»£ç 
- âœ… åˆå§‹åŒ–æ•°æ®åº“
- âœ… é…ç½® Nginx åå‘ä»£ç†
- âœ… å¯åŠ¨åç«¯æœåŠ¡ï¼ˆPM2ï¼‰
- âœ… é…ç½®é˜²ç«å¢™

**é¢„è®¡æ—¶é—´**: 5-15 åˆ†é’Ÿï¼ˆå–å†³äºç½‘ç»œé€Ÿåº¦ï¼‰

---

## ğŸ‰ éƒ¨ç½²å®Œæˆ

éƒ¨ç½²æˆåŠŸåï¼Œä½ ä¼šçœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š

```
============================================
[SUCCESS] éƒ¨ç½²å®Œæˆï¼
============================================

è®¿é—®åœ°å€:
  å‰ç«¯é¡µé¢: http://47.96.174.6
  åç«¯ API: http://47.96.174.6/api

æç¤º:
  - è¯·ç¡®ä¿æœåŠ¡å™¨å®‰å…¨ç»„/é˜²ç«å¢™å·²å¼€æ”¾ 80 ç«¯å£
  - å¦‚æœæ— æ³•è®¿é—®ï¼Œè¯·æ£€æŸ¥äº‘æœåŠ¡å•†çš„å®‰å…¨ç»„è®¾ç½®
```

### è®¿é—®åº”ç”¨
åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š**http://47.96.174.6**

---

## ğŸ“Š æœåŠ¡ç®¡ç†å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
# æŸ¥çœ‹åç«¯æœåŠ¡çŠ¶æ€
pm2 status

# æŸ¥çœ‹ Nginx çŠ¶æ€
systemctl status nginx

# æŸ¥çœ‹ MongoDB çŠ¶æ€
systemctl status mongod
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# æŸ¥çœ‹åç«¯å®æ—¶æ—¥å¿—
pm2 logs eduapp-server

# æŸ¥çœ‹ Nginx è®¿é—®æ—¥å¿—
tail -f /var/log/nginx/eduapp-access.log

# æŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—
tail -f /var/log/nginx/eduapp-error.log
```

### é‡å¯æœåŠ¡
```bash
# é‡å¯åç«¯æœåŠ¡
pm2 restart eduapp-server

# é‡å¯ Nginx
systemctl restart nginx

# é‡å¯ MongoDB
systemctl restart mongod
```

### åœæ­¢æœåŠ¡
```bash
# åœæ­¢åç«¯æœåŠ¡
pm2 stop eduapp-server

# åœæ­¢ Nginx
systemctl stop nginx
```

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜1: æ— æ³•è®¿é—®ç½‘ç«™

#### æ£€æŸ¥æ­¥éª¤ï¼š
```bash
# 1. æ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ
pm2 status

# 2. æ£€æŸ¥ Nginx æ˜¯å¦è¿è¡Œ
systemctl status nginx

# 3. æ£€æŸ¥ç«¯å£ç›‘å¬
netstat -tuln | grep -E '80|3210'

# 4. æ£€æŸ¥é˜²ç«å¢™
firewall-cmd --list-all
```

#### å¸¸è§åŸå› ï¼š
- âŒ äº‘æœåŠ¡å™¨å®‰å…¨ç»„æœªå¼€æ”¾ 80 ç«¯å£ â†’ **å»äº‘æ§åˆ¶å°å¼€æ”¾**
- âŒ ç³»ç»Ÿé˜²ç«å¢™é˜»æ­¢ â†’ `firewall-cmd --permanent --add-service=http && firewall-cmd --reload`
- âŒ Nginx é…ç½®é”™è¯¯ â†’ `nginx -t` æŸ¥çœ‹é”™è¯¯
- âŒ åç«¯æœåŠ¡æœªå¯åŠ¨ â†’ `pm2 restart eduapp-server`

### é—®é¢˜2: API è¯·æ±‚å¤±è´¥

#### æ£€æŸ¥æ­¥éª¤ï¼š
```bash
# 1. æµ‹è¯•åç«¯ API
curl http://localhost:3210/api/health

# 2. æŸ¥çœ‹åç«¯æ—¥å¿—
pm2 logs eduapp-server --lines 50

# 3. æŸ¥çœ‹ Nginx ä»£ç†æ—¥å¿—
tail -f /var/log/nginx/eduapp-error.log
```

#### å¸¸è§åŸå› ï¼š
- âŒ MongoDB æœªå¯åŠ¨ â†’ `systemctl start mongod`
- âŒ ç¯å¢ƒå˜é‡é…ç½®é”™è¯¯ â†’ æ£€æŸ¥ `/mnt/sda2/code/edu_app/server/.env`
- âŒ Claude API Key æ— æ•ˆ â†’ æ›´æ–° `.env` æ–‡ä»¶ä¸­çš„ `ANTHROPIC_API_KEY`

### é—®é¢˜3: å‰ç«¯æ˜¾ç¤ºä½† API ä¸é€š

#### æ£€æŸ¥ Nginx é…ç½®ï¼š
```bash
# æŸ¥çœ‹ Nginx é…ç½®
cat /etc/nginx/conf.d/eduapp.conf

# æµ‹è¯•é…ç½®
nginx -t

# é‡å¯ Nginx
systemctl restart nginx
```

---

## ğŸ”„ æ›´æ–°éƒ¨ç½²

### æ–¹æ³•1ï¼šä½¿ç”¨ Git æ‹‰å–æ›´æ–°
```bash
cd /mnt/sda2/code/edu_app

# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# é‡æ–°æ„å»ºå‰ç«¯
cd client
npm install
npm run build

# é‡å¯åç«¯
pm2 restart eduapp-server
```

### æ–¹æ³•2ï¼šé‡æ–°è¿è¡Œéƒ¨ç½²è„šæœ¬
```bash
cd /mnt/sda2/code/edu_app
sudo ./deploy.sh
```
**æ³¨æ„**: ä¼šè¦†ç›– `.env` æ–‡ä»¶ï¼Œè¯·å…ˆå¤‡ä»½é…ç½®ã€‚

---

## ğŸ“ é…ç½®æ–‡ä»¶ä½ç½®

| æ–‡ä»¶ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| åç«¯ç¯å¢ƒå˜é‡ | `/mnt/sda2/code/edu_app/server/.env` | API Keyã€æ•°æ®åº“è¿æ¥ç­‰ |
| å‰ç«¯ç¯å¢ƒå˜é‡ | `/mnt/sda2/code/edu_app/client/.env.production` | API åœ°å€é…ç½® |
| Nginx é…ç½® | `/etc/nginx/conf.d/eduapp.conf` | Web æœåŠ¡å™¨é…ç½® |
| PM2 é…ç½® | `~/.pm2/` | è¿›ç¨‹ç®¡ç†é…ç½® |

---

## ğŸ” å®‰å…¨å»ºè®®

### 1. ä¿®æ”¹ MongoDB è®¤è¯
```bash
mongosh
use admin
db.createUser({
  user: "admin",
  pwd: "å¼ºå¯†ç ",
  roles: [ { role: "userAdminAnyDatabase", db: "admin" } ]
})
exit
```

### 2. é…ç½® HTTPSï¼ˆå¯é€‰ä½†æ¨èï¼‰
ä½¿ç”¨ Let's Encrypt å…è´¹è¯ä¹¦ï¼š
```bash
# å®‰è£… certbot
yum install -y certbot python3-certbot-nginx

# è·å–è¯ä¹¦ï¼ˆéœ€è¦åŸŸåï¼‰
certbot --nginx -d yourdomain.com
```

### 3. é™åˆ¶ SSH è®¿é—®
```bash
# åªå…è®¸å¯†é’¥ç™»å½•ï¼Œç¦æ­¢å¯†ç ç™»å½•
nano /etc/ssh/sshd_config
# ä¿®æ”¹: PasswordAuthentication no

systemctl restart sshd
```

---

## ğŸ“ è·å–å¸®åŠ©

### å¸¸ç”¨èµ„æº
- [å®Œæ•´éƒ¨ç½²æ•™ç¨‹](./éƒ¨ç½²æ•™ç¨‹.md)
- [é¡¹ç›® README](../README.md)
- [å¼€å‘è®¡åˆ’](./å¼€å‘è®¡åˆ’.md)

### é—®é¢˜åé¦ˆ
å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æ—¥å¿—æ–‡ä»¶ï¼ˆ`pm2 logs` å’Œ `/var/log/nginx/`ï¼‰
2. é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
3. å®‰å…¨ç»„å’Œé˜²ç«å¢™è®¾ç½®

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-10-29
**é€‚ç”¨ç³»ç»Ÿ**: CentOS 7/8, RHEL 7/8
