# 🚀 witdot 中小学生 AI 教育平台开发计划

## 📋 项目概述

**项目名称**: witdot Education AI Platform
**定位**: 中小学生 AI 通识教育 + 画布编程学习平台
**核心理念**: 通过可视化编程（Blockly）让学生理解 AI 原理，培养计算思维

### 平台架构
```
witdot Education AI Platform
├── 1. AI通识课
│   ├── 小学课程
│   │   ├── 1-3年级通识课
│   │   └── 4-6年级通识课
│   │       └── 走进AI系列课（当前核心课程）
│   └── 初中课程
├── 2. 画布编程
│   ├── 图像识别画板（固定Agent示例）
│   ├── 语音助手画板
│   └── 机器人画板
└── 3. 机器人编程（未来规划）
```

---

## 🎯 开发阶段规划（MVP 优先）

### 📦 第一阶段：项目初始化与基础架构（第1-2周）

#### 1.1 项目脚手架搭建
- [x] 创建 monorepo 结构（client + server）
- [x] 前端：Vite + React 18 + TailwindCSS
- [x] 后端：Node.js + Express + MongoDB
- [x] 配置 ESLint、Prettier、Git Hooks

#### 1.2 基础布局组件
- [x] **顶部导航栏**
  - Logo（witdot）
  - 导航菜单：AI通识课 / 画布编程 / 我的学习
  - 用户头像/登录按钮
  - 搜索框（右上方）
- [x] **页面容器组件**（响应式布局）
- [x] **路由配置**（React Router v6）

#### 1.3 用户认证系统
- [x] 注册/登录页面（简洁设计）
- [x] JWT Token 认证（后端实现完成）
- [x] 用户角色：学生 / 教师
- [x] 登录状态管理（Zustand）
- [x] 密码加密（bcrypt）
- [x] 前端 API 调用封装（Axios）
- [x] Sidebar 用户信息显示和登出功能

#### 1.4 数据库设计（MongoDB）
- [x] users 模型创建
- [x] courses 模型完善（支持 PPT 和视频）
- [x] projects 模型创建
- [ ] records 模型创建
- [ ] templates 模型创建

#### 1.5 静态资源管理
- [x] 创建静态文件目录结构
- [x] PPT 文件存储和访问
- [x] 配置 Express 静态文件服务
- [ ] 视频文件上传和管理

---

### 📚 第二阶段：AI 通识课程模块（第3-5周）

#### 2.1 课程分类系统
- [x] **小学课程**
  - [ ] 1-3年级通识课（简化版）
  - [x] 4-6年级通识课
    - **AI 通识教育课程（小学高年级-初中）**（已完成）
- [ ] **初中课程**（预留接口）

#### 2.2 课程核心功能
- [x] **课程配置系统**
  - [x] JSON 配置文件管理课程数据
  - [x] 课程索引文件
  - [x] 自动同步到数据库
- [x] **课程列表页**
  - [x] 课程卡片（封面 + 标题 + 简介 + 适合年级）
  - [x] 年级和分类筛选
  - [x] 学习进度条（显示已完成章节数和百分比）
- [x] **课程详情页**
  - [x] 章节目录导航
  - [x] 课程介绍和学习目标
  - [ ] AI 助教对话框（右侧，可收起）
- [x] **章节学习页**
  - [x] 章节内容展示
  - [x] 视频播放器（mp4 支持）
  - [x] PPT 在线预览/下载
  - [x] 学习时长自动记录
  - [x] 标记章节完成按钮
  - [x] 完成状态显示
  - [ ] 互动练习题

#### 2.3 AI 助教功能（Claude API）
- [x] 集成 Claude API
- [x] **功能**：
  - [x] "我不懂，请帮我讲解" 按钮（全局 AI 助教）
  - [x] 上下文理解（当前课程内容）
  - [x] 针对性解答（适合学生年龄）
  - [x] 儿童友好的 system prompt
- [ ] 对话历史保存（到数据库）
- [x] 流式回复展示（打字机效果）
- [x] 标签过滤（过滤 <think>，只显示 <answer>）
- [x] **全局 AI 助教**
  - [x] 可爱的悬浮按钮设计
  - [x] 全局显示（所有页面可见）
  - [x] 通用 AI 学习助手
  - [x] 光晕和动画效果
- [ ] **课程页面集成**
  - [ ] 章节学习页添加 AI 助教（基于课程内容）

#### 2.4 学习进度追踪
- [x] 记录章节完成状态
- [x] 课程完成百分比
- [x] 学习时长统计（自动记录）
- [x] 学习进度 API（后端）
- [x] 学习进度显示（前端）
- [ ] 学习数据可视化（图表）

---

### 🎨 第三阶段：画布编程模块（第6-10周）

#### 3.1 Blockly 技术选型与集成
**评估开源库**（选择最简单的）：
1. ✅ **Google Blockly**（推荐）- 最成熟、文档完善
2. Microsoft PXT - 适合硬件编程
3. OpenBlock - 基于 Scratch 3.0
4. Scratch GUI - 完整 IDE（过重）

**决策**：使用 **Google Blockly**

- [x] 引入 Blockly 库
- [x] 配置基础工作区（Workspace）
- [x] 设计简洁的工具箱（Toolbox）

#### 3.2 自定义积木设计
**分类**：
1. **基础逻辑**
   - [x] 等待 N 秒
   - [x] 重复 N 次
   - [x] 如果...则...

2. **AI 功能积木**
   - [x] 调用 AI 生成文本
   - [x] 图像识别
   - [ ] 语音识别

3. **输入输出**
   - [x] 获取用户输入
   - [x] 显示结果
   - [ ] 播放声音

#### 3.3 三种画板实现（挑选最简单的作为 MVP）

##### 🥇 优先级 P0：图像识别画板（固定 Agent）
**功能**：
- [x] 图片上传组件
- [x] 预设 Blockly 流程（固定积木）：
  ```
  1. 上传图片
  2. 调用 Claude API（图像识别）
  3. 显示识别结果
  ```
- [x] 预览区（显示上传图片 + 识别结果）
- [x] **示例 Agent**："图像识别助手"（固定逻辑）
- [x] BlocklyEditor React 组件封装
- [x] 画布编程主页导航

**实现思路**：
- 学生可以修改提示词参数
- 主流程预设，方便理解 Agent 运行机制
- 支持代码生成和异步执行

##### 🥈 优先级 P1：语音助手画板
- [ ] Web Speech API 集成
- [ ] 语音转文本
- [ ] 调用 Claude API 对话
- [ ] 文本转语音播报

##### 🥉 优先级 P2：机器人画板
- [ ] Canvas 绘制虚拟角色
- [ ] 移动、旋转动画
- [ ] Blockly 控制指令

#### 3.4 项目保存与管理
- [x] 保存 Blockly JSON 到 MongoDB
- [x] 我的作品列表（MyProjects 页面）
- [x] 加载已保存项目
- [x] 项目更新功能
- [x] 项目删除功能
- [x] 项目分类筛选
- [ ] 导出/分享功能（生成链接）

#### 3.5 后端 API 实现
- [x] 图像识别 API 端点（/api/ai/image-recognition）
- [x] 文本生成 API 端点（/api/ai/text-generate）
- [x] 项目 CRUD API（/api/projects）
- [x] Claude API 集成服务

---

### 🏫 第四阶段：教师功能（第11-12周）

#### 4.1 教师仪表板
- [ ] 学生列表与统计
- [ ] 课程管理
  - 创建/编辑课程
  - 章节管理
  - 测验题库

#### 4.2 作业批改
- [ ] 学生作品列表
- [ ] 查看学生 Blockly 项目
- [ ] 打分与评语
- [ ] （可选）AI 辅助评分建议

#### 4.3 数据统计
- [ ] 课程完成率
- [ ] 学生活跃度
- [ ] 测验成绩分析

---

### 🌟 第五阶段：优化与完善（第13-15周）

#### 5.1 UI/UX 优化
- [ ] 响应式设计（移动端适配）
- [ ] 动画效果（过渡、加载）
- [ ] 无障碍优化（ARIA）
- [ ] 主题色系统（可选浅色/深色）

#### 5.2 性能优化
- [ ] 代码分割（React.lazy）
- [ ] 图片懒加载
- [ ] Blockly 工作区性能优化
- [ ] MongoDB 索引优化

#### 5.3 安全加固
- [ ] XSS 防护
- [ ] CSRF 防护
- [ ] API 限流（防止滥用 Claude API）
- [ ] 输入验证

---

### 🚀 第六阶段：测试与部署（第16-18周）

#### 6.1 测试
- [ ] 前端组件测试（Vitest）
- [ ] 后端 API 测试（Jest）
- [ ] E2E 测试（Playwright）
- [ ] 真实学生小规模测试

#### 6.2 部署
- [ ] 前端部署（Vercel / Netlify）
- [ ] 后端部署（阿里云 / Railway）
- [ ] MongoDB Atlas（云数据库）
- [ ] 域名与 SSL 证书

---

## 📊 里程碑与交付物

| 阶段 | 时间 | 核心交付物 | 验收标准 | 状态 |
|------|------|-----------|---------|------|
| 第1-2周 | 基础搭建 | 登录系统 + 基础布局 | 可登录并访问首页 | ✅ 已完成 |
| 第3-5周 | AI 通识课 | "走进AI系列课"完整功能 | 可学习课程 + AI助教对话 | ✅ 已完成 |
| 第6-10周 | 画布编程 | 图像识别画板（固定Agent） | 可运行预设 Agent + 项目保存 | ✅ 基础完成 |
| 第11-12周 | 教师功能 | 教师后台基础功能 | 教师可管理课程和学生 | 🔄 待开发 |
| 第13-15周 | 优化完善 | UI/UX + 性能优化 | 流畅体验 + 移动端适配 | 🔄 待开发 |
| 第16-18周 | 上线 | 生产环境部署 | 真实学生可访问使用 | 🔄 待开发 |

---

## 🛠 技术选型

### 前端技术栈
```json
{
  "framework": "React 18",
  "buildTool": "Vite",
  "styling": "TailwindCSS",
  "routing": "React Router v6",
  "stateManagement": "Zustand",
  "visualProgramming": "Google Blockly",
  "httpClient": "Axios",
  "markdown": "react-markdown"
}
```

### 后端技术栈
```json
{
  "runtime": "Node.js 18+",
  "framework": "Express",
  "database": "MongoDB + Mongoose",
  "authentication": "JWT + bcrypt",
  "validation": "Zod",
  "logger": "Winston"
}
```

### AI 集成
- **Claude API** (Anthropic) - AI 助教 + Agent 执行
- **Web Speech API** - 语音识别（浏览器原生）

### 可视化编程库选择
**最终选择**：[Google Blockly](https://github.com/google/blockly)

**理由**：
1. ✅ 文档完善，社区活跃
2. ✅ 可高度自定义积木
3. ✅ 轻量级，易于集成
4. ✅ 支持多种代码生成器

---

## 🎨 设计规范

### 色彩系统
- **主色**：蓝色（#3B82F6）- 科技感
- **辅助色**：
  - 绿色（#10B981）- 成功/完成
  - 橙色（#F59E0B）- 警告/提示
  - 紫色（#8B5CF6）- AI 相关功能
- **中性色**：灰度系统

### 组件设计原则
- 简洁清晰（适合中小学生）
- 大按钮、大字体（易于操作）
- 丰富的视觉反馈（动画、提示）
- 友好的错误提示

---

## 📝 开发注意事项

### 1. 教育场景特殊考虑
- 📱 **低龄适配**：界面简单、提示清晰
- 🛡️ **内容安全**：AI 回复需过滤不当内容
- 🎯 **学习目标明确**：每个课程/画板有清晰的教学目标
- 📊 **进度可视化**：让学生有成就感

### 2. Blockly 开发要点
- 积木设计要直观（用中文命名）
- 避免过于复杂的逻辑嵌套
- 提供丰富的示例项目
- 错误提示友好（不要技术术语）

### 3. Claude API 使用规范
- **Prompt 设计**：
  - 明确角色（AI 助教 for 小学生）
  - 限制回复长度（避免过长）
  - 要求简单语言（避免专业术语）
- **成本控制**：
  - 设置 Token 限制
  - API 调用频率限制
  - 缓存常见问题回答

### 4. 性能优化
- Blockly 工作区避免过多积木（影响性能）
- 图片上传限制大小（< 2MB）
- API 请求防抖（避免频繁调用）

### 5. 安全性
- 学生上传内容审核
- API Key 环境变量管理
- 防止恶意代码注入（Blockly 代码沙箱）

---

## 📚 参考资源

### 可视化编程库
1. [Google Blockly](https://github.com/google/blockly) ⭐ 推荐
2. [Microsoft PXT](https://github.com/microsoft/pxt)
3. [OpenBlock](https://github.com/openblockcc)
4. [Scratch GUI](https://github.com/scratchfoundation/scratch-gui)

### 技术文档
- [Blockly 开发者指南](https://developers.google.com/blockly/guides/overview)
- [React 官方文档](https://react.dev)
- [Claude API 文档](https://docs.anthropic.com/claude/reference)
- [TailwindCSS 文档](https://tailwindcss.com)

---

## 🎯 MVP 范围定义

### ✅ MVP 必须包含
1. **AI 通识课**：
   - "走进AI系列课"（4-6年级）
   - 至少 5 个章节
   - AI 助教对话功能
   - 简单测验

2. **画布编程**：
   - 图像识别画板（固定 Agent 示例）
   - 至少 10 个自定义积木
   - 项目保存功能

3. **基础功能**：
   - 用户登录/注册
   - 学习进度记录
   - 我的作品列表

### ❌ MVP 暂不包含
- 社区功能（点赞、评论）
- 作品画廊
- 高级教师统计
- 机器人编程模块
- 移动端 App

---

## 🚦 下一步行动

### 第1周
1. ✅ 确认技术选型（Blockly）
2. 🔨 搭建前后端项目脚手架
3. 🎨 设计首页线框图
4. 📝 编写数据库 Schema

### 第2周
1. 🔐 实现登录注册功能
2. 📚 创建课程数据模型
3. 🧪 测试 Blockly 基础集成
4. 📖 准备"走进AI系列课"课程内容

### 第3周
1. 📚 开发课程列表页
2. 📖 开发课程详情页
3. 🤖 集成 Claude API（AI 助教）
4. 💾 实现学习进度保存

---

## 📞 项目信息

- **项目周期**：18 周（约 4.5 个月）
- **核心团队**：前端 + 后端 + 内容编写
- **目标用户**：小学 4-6 年级、初中学生
- **首发课程**："走进AI系列课"

---

**文档版本**: v2.2
**最后更新**: 2025-10-27
**维护者**: witdot Development Team

---

## 📝 更新日志

### v2.2 (2025-10-27)
- ✅ 修复 Vite 路径别名配置（@/ 指向 src/）
- ✅ 解决 Express 请求体大小限制（增加至 10MB 支持图片上传）
- ✅ 图像识别功能完整测试通过
- ✅ 移除所有调试代码，优化代码可读性
- ✅ 优化页面布局：将识别结果显示区移至页面顶部
- ✅ 完善错误处理和用户提示

### v2.1 (2025-10-26)
- ✅ 完成 Blockly 集成和工作区配置
- ✅ 实现自定义 AI 积木（图像识别、文本生成）
- ✅ 完成图像识别画板核心功能
- ✅ 实现 BlocklyEditor React 组件
- ✅ 创建画布编程主页导航
- ✅ 实现项目保存/加载/删除功能
- ✅ 完成后端 API（图像识别、文本生成、项目管理）
- ✅ 集成 Claude API 图像识别服务

### v2.0 (2025-10-25)
- 初始开发计划制定
- 技术栈确定
